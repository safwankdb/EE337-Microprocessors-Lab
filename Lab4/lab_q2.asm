ORG 00H
LJMP MAIN

; delay of 1 sec
DELAY:
	MOV R3, #20
	BACK0:
	MOV R2, #200
	BACK1:
	MOV R1, #0FFH
	BACK:
	DJNZ R1, BACK
	DJNZ R2, BACK1
	DJNZ R3, BACK0
	RET

READNIBBLE:
	MOV P1, #0FFH
	LCALL DELAY
	LCALL DELAY
	LCALL DELAY
	LCALL DELAY
	LCALL DELAY
	ANL P1, #00FH
	LCALL DELAY
	MOV A, P1
	ANL A, #00FH
	MOV @R0, A
	RL A
	RL A
	RL A
	RL A
	MOV P1, A
	LCALL DELAY
	LCALL DELAY
	LCALL DELAY
	LCALL DELAY
	LCALL DELAY
	MOV P1, #00FH
	LCALL DELAY
	MOV P1, #0FFH
	LCALL DELAY
	ANL P1, #00FH
	MOV A, P1
	ANL A, #00FH
	CJNE A, #00FH, READNIBBLE
	MOV P1, #0
	LCALL DELAY
	RET

PACKNIBBLES:
	MOV A, 4EH
	RL A
	RL A
	RL A
	RL A
	ADD A, 4FH
	MOV @R0, A
	RET

ORG 100H

MAIN:
	MOV R0, #4EH
	LCALL READNIBBLE
	MOV R0, #4FH
	LCALL READNIBBLE
	MOV R0, #50H
	LCALL PACKNIBBLES
	MOV R0, #4EH
	LCALL READNIBBLE
	MOV R0, #4FH
	LCALL READNIBBLE
	MOV R0, #51H
	LCALL PACKNIBBLES
	MOV A, 50H
	ADD A, 51H
	CPL A
	ADD A, #1
	MOV B, A
	ANL A, #00FH
	RL A
	RL A
	RL A
	RL A
	MOV P1, A
	LCALL DELAY
	LCALL DELAY
	MOV P1, B
END

